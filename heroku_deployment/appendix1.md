# APPENDIX1. コード内に埋め込みたくない情報を外部化するには?

## 目的

* APIキーやパスワードなど、ソースに埋め込みたくない情報を外部化させる。

## 背景

今回の1dayインターンで作成するアプリでは、flickr API の API キーを使用します。

一方で、今回、ソースコードは GitHub で管理しています。

GitHub はクラウドサービスなので、インターネット上にあります。
Public リポジトリを使っている場合は、APIキーなどの秘密情報をソースリポジトリに含めてしまうと、
APIキーの情報が一般に公開されてしまいます。
また、Private リポジトリを使用している場合でも、
ソースリポジトリを閲覧できるメンバーであれば、誰でも APIキーを閲覧できてしまいます。

このように、API キーなどの秘密情報をソースコードに埋め込んでしまうと、
秘密情報が外部に漏洩するリスクが高くなります。

ソースコードに埋め込まずに、秘密情報はどのように管理すればよいのでしょうか？

## heroku の環境変数

heroku の場合、環境変数を使ってアプリが起動時に利用する情報をコマンドラインから設定することができます。

```
$ heroku config:add FLICKR_API_KEY="(flickrのAPIキー)"
```

設定した環境変数は、Node.js のソースコードからは以下のように利用します。

```javascript:
flicker_api_key = process.env.FLICKR_API_KEY;
```

このように、環境変数を使うことで、APIキーなどの秘密情報をソースリポジトから分離することができます。

他にも、環境変数を使うメリットとして、ステージング環境と本番環境で別々の情報を設定することなど
が挙げられます。

## やってみよう

* heroku-toolbelt を使って、heroku 上のアプリに環境変数 LANG を設定する。
app.js から環境変数 LANG の内容を表示させる。

[課題:](exercise1.md)

## 参考

[HerokuでWebアプリ開発を始めるなら知っておきたいこと(5) 環境変数ENV](http://blog.ruedap.com/2011/05/03/ruby-heroku-web-app-development-tips-5)
